import{ax as D,r as n,al as e,aD as E,aE as L,aF as k,aG as z}from"./index-C1dXcKKh.js";import{C as A}from"./check-CwRgc88d.js";const _=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}]],C=D("clock",_);const Q=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],U=D("pencil",Q),T=["mon","tue","wed","thu","fri","sat","sun"],M={mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday",sun:"Sunday"},$=["Scheduled","Drafts","Posted","Failed"];function q(l=7){const i=[],d=new Date;for(let o=0;o<l;o++){const c=new Date(d);c.setDate(d.getDate()+o);const m=c.toLocaleDateString("en-US",{weekday:"short"}).toLowerCase(),u=o===0?"Today":o===1?"Tomorrow":c.toLocaleDateString("en-US",{weekday:"long"});i.push({date:c,dow:m,label:u})}return i}function P(l){if(!l)return"";const[i,d]=l.split(":").map(Number),o=i>=12?"PM":"AM",c=i%12||12;return`${String(c).padStart(2,"0")}:${String(d).padStart(2,"0")} ${o}`}function F({times:l,onSave:i,onClose:d}){const[o,c]=n.useState(()=>{const s={};return T.forEach(a=>{s[a]=[...l[a]||[]]}),s}),[m,u]=n.useState({}),[y,h]=n.useState(!1),f=s=>{const a=m[s];a&&(c(r=>({...r,[s]:[...r[s]||[],a].sort()})),u(r=>({...r,[s]:""})))},v=(s,a)=>{c(r=>({...r,[s]:r[s].filter((b,g)=>g!==a)}))},j=async()=>{h(!0);try{await fetch("/api/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({queueTimes:o})}),i(o)}catch{}h(!1)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0,0,0,0.6)"},children:e.jsxs("div",{className:"card w-full max-w-lg max-h-[80vh] overflow-y-auto",style:{background:"var(--color-surface)"},children:[e.jsxs("div",{className:"flex items-center justify-between p-5 border-b",style:{borderColor:"var(--color-border-subtle)"},children:[e.jsx("h2",{className:"font-semibold text-[15px]",children:"Edit Queue Times"}),e.jsx("button",{onClick:d,className:"hover:opacity-70 transition-opacity",children:e.jsx(k,{className:"w-4 h-4",style:{color:"var(--color-text-muted)"}})})]}),e.jsx("div",{className:"p-5 space-y-4",children:T.map(s=>e.jsxs("div",{children:[e.jsx("p",{className:"text-[12px] font-semibold mb-1.5",style:{color:"var(--color-text-secondary)"},children:M[s]}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:(o[s]||[]).map((a,r)=>e.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 rounded-full text-[11px] font-medium",style:{background:"oklch(0.65 0.19 250 / 0.1)",color:"var(--color-primary)"},children:[P(a),e.jsx("button",{onClick:()=>v(s,r),className:"hover:opacity-70",children:e.jsx(k,{className:"w-2.5 h-2.5"})})]},r))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"time",value:m[s]||"",onChange:a=>u(r=>({...r,[s]:a.target.value})),onKeyDown:a=>a.key==="Enter"&&f(s),className:"px-2.5 py-1.5 rounded-lg text-[12px] border",style:{background:"var(--color-bg)",borderColor:"var(--color-border-subtle)",color:"var(--color-text)"}}),e.jsxs("button",{onClick:()=>f(s),disabled:!m[s],className:"px-3 py-1.5 text-[11px] rounded-lg disabled:opacity-40 font-medium flex items-center gap-1 transition-opacity hover:opacity-80",style:{background:"oklch(0.65 0.19 250 / 0.1)",color:"var(--color-primary)"},children:[e.jsx(z,{className:"w-3 h-3"})," Add"]})]})]},s))}),e.jsxs("div",{className:"p-5 border-t flex justify-end gap-3",style:{borderColor:"var(--color-border-subtle)"},children:[e.jsx("button",{onClick:d,className:"px-4 py-2 text-[13px] rounded-lg font-medium hover:opacity-80 transition-opacity",style:{color:"var(--color-text-secondary)"},children:"Cancel"}),e.jsxs("button",{onClick:j,disabled:y,className:"px-4 py-2 text-[13px] rounded-lg font-medium bg-gradient-to-r from-primary to-accent text-white disabled:opacity-50 flex items-center gap-1.5 hover:opacity-90 transition-opacity",children:[y?e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-2 border-white border-t-transparent"}):e.jsx(A,{className:"w-3.5 h-3.5"}),"Save Times"]})]})]})})}const I="https://postiz.pro/oliverhenry";function G(){const[l,i]=n.useState("Scheduled"),[d,o]=n.useState(!1),[c,m]=n.useState({}),[u,y]=n.useState([]),[h,f]=n.useState(null),[v,j]=n.useState(!0),[s,a]=n.useState(null),r=q(7);n.useEffect(()=>{Promise.all([fetch("/api/config").then(t=>t.json()).catch(()=>({})),fetch("/api/queue").then(t=>t.json()).catch(()=>({posts:[]}))]).then(([t,x])=>{m(t.queueTimes||{}),f(t.user||null),y(x.posts||[]),a(!!t.postizKey),j(!1)})},[]);const b=t=>c[t]||[],g=(t,x)=>u.find(N=>{const p=new Date(N.scheduledAt);return p.toDateString()===t.toDateString()&&`${String(p.getHours()).padStart(2,"0")}:${String(p.getMinutes()).padStart(2,"0")}`===x});return v?e.jsx("div",{className:"p-8 flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-primary border-t-transparent"})}):e.jsxs("div",{className:"p-6 space-y-5 w-full",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Queue"}),h&&e.jsxs("p",{className:"text-[12px] mt-0.5",style:{color:"var(--color-text-muted)"},children:["@",h.username]})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg text-[13px] font-medium border hover:opacity-80 transition-opacity",style:{borderColor:"var(--color-border)",color:"var(--color-text-secondary)"},children:[e.jsx(C,{className:"w-3.5 h-3.5"}),"Edit Queue"]})]}),e.jsx("div",{className:"flex gap-1.5 p-1 rounded-full w-fit",style:{background:"var(--color-bg-secondary)"},children:$.map(t=>e.jsx("button",{onClick:()=>i(t),className:`px-4 py-1.5 rounded-full text-[12px] font-medium transition-all duration-150 ${l===t?"text-white bg-gradient-to-r from-primary to-accent shadow-sm":"hover:opacity-80"}`,style:{color:l===t?void 0:"var(--color-text-secondary)"},children:t},t))}),s===!1&&e.jsxs("div",{className:"card p-4 flex items-center justify-between gap-4",style:{background:"oklch(0.65 0.19 250 / 0.08)",border:"1px solid oklch(0.65 0.19 250 / 0.3)"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[13px] font-semibold",style:{color:"var(--color-primary)"},children:"Connect Postiz to schedule tweets"}),e.jsx("p",{className:"text-[11px] mt-0.5",style:{color:"var(--color-text-muted)"},children:"Postiz lets you schedule, queue and auto-post to X and other platforms."})]}),e.jsx("a",{href:I,target:"_blank",rel:"noopener",className:"shrink-0 px-4 py-2 rounded-lg text-[12px] font-semibold text-white hover:opacity-90 transition-opacity",style:{background:"var(--color-primary)"},children:"Set up Postiz â†’"})]}),l==="Scheduled"?e.jsxs("div",{className:"space-y-5",children:[r.map(({date:t,dow:x,label:N})=>{const p=b(x);return p.length===0?null:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(E,{className:"w-3.5 h-3.5",style:{color:"var(--color-text-muted)"}}),e.jsx("h2",{className:"text-[13px] font-semibold",children:N}),e.jsx("span",{className:"text-[11px]",style:{color:"var(--color-text-muted)"},children:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsx("div",{className:"space-y-2 pl-5",children:p.map(S=>{const w=g(t,S);return e.jsxs("div",{className:"card p-4 flex items-start gap-4",children:[e.jsx("div",{className:"shrink-0 mt-0.5",children:e.jsx("span",{className:"text-[12px] font-mono font-semibold",style:{color:"var(--color-primary)"},children:P(S)})}),w?e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[13px] line-clamp-3",children:w.text}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs("button",{className:"text-[11px] hover:opacity-80 transition-opacity flex items-center gap-1",style:{color:"var(--color-text-muted)"},children:[e.jsx(U,{className:"w-3 h-3"})," Edit"]}),e.jsxs("button",{className:"text-[11px] hover:opacity-80 transition-opacity flex items-center gap-1 text-danger",children:[e.jsx(L,{className:"w-3 h-3"})," Delete"]})]})]}):e.jsx("p",{className:"text-[12px] italic flex-1",style:{color:"var(--color-text-muted)"},children:"Press 'Add to Queue' to schedule your post"})]},S)})})]},x)}),r.every(({dow:t})=>b(t).length===0)&&e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx(C,{className:"w-8 h-8 mx-auto mb-3",style:{color:"var(--color-text-muted)"}}),e.jsx("p",{className:"text-[14px] font-medium",children:"No queue times set"}),e.jsx("p",{className:"text-[12px] mt-1 mb-4",style:{color:"var(--color-text-muted)"},children:'Click "Edit Queue" to set your default posting schedule'}),e.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 text-[13px] font-medium rounded-lg bg-gradient-to-r from-primary to-accent text-white hover:opacity-90 transition-opacity",children:"Set Up Schedule"})]})]}):e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx("p",{className:"text-[14px] font-medium",children:l}),e.jsxs("p",{className:"text-[12px] mt-1",style:{color:"var(--color-text-muted)"},children:["No ",l.toLowerCase()," posts yet"]})]}),d&&e.jsx(F,{times:c,onSave:t=>{m(t),o(!1)},onClose:()=>o(!1)})]})}export{G as default};
